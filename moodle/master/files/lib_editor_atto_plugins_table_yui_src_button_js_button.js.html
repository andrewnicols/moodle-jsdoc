<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/editor/atto/plugins/table/yui/src/button/js/button.js - Moodle</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Moodle"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Bootstrap.Collapse.html">Bootstrap.Collapse</a></li>
            
                <li><a href="../classes/Bootstrap.Dropdown.html">Bootstrap.Dropdown</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.annotation.html">M.assignfeedback_editpdf.annotation</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.annotationhighlight.html">M.assignfeedback_editpdf.annotationhighlight</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.annotationline.html">M.assignfeedback_editpdf.annotationline</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.annotationoval.html">M.assignfeedback_editpdf.annotationoval</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.annotationpen.html">M.assignfeedback_editpdf.annotationpen</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.annotationrectangle.html">M.assignfeedback_editpdf.annotationrectangle</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.annotationstamp.html">M.assignfeedback_editpdf.annotationstamp</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.colourpicker.html">M.assignfeedback_editpdf.colourpicker</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.comment.html">M.assignfeedback_editpdf.comment</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.commentmenu.html">M.assignfeedback_editpdf.commentmenu</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.commentsearch.html">M.assignfeedback_editpdf.commentsearch</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.drawable.html">M.assignfeedback_editpdf.drawable</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.dropdown.html">M.assignfeedback_editpdf.dropdown</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.edit.html">M.assignfeedback_editpdf.edit</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.editor.html">M.assignfeedback_editpdf.editor</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.point.html">M.assignfeedback_editpdf.point</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.quickcomment.html">M.assignfeedback_editpdf.quickcomment</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.quickcommentlist.html">M.assignfeedback_editpdf.quickcommentlist</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.rect.html">M.assignfeedback_editpdf.rect</a></li>
            
                <li><a href="../classes/M.assignfeedback_editpdf.stamppicker.html">M.assignfeedback_editpdf.stamppicker</a></li>
            
                <li><a href="../classes/M.atto_accessibilitychecker.Button.html">M.atto_accessibilitychecker.Button</a></li>
            
                <li><a href="../classes/M.atto_accessibilityhelper.Button.html">M.atto_accessibilityhelper.Button</a></li>
            
                <li><a href="../classes/M.atto_align.button.html">M.atto_align.button</a></li>
            
                <li><a href="../classes/M.atto_backcolor.button.html">M.atto_backcolor.button</a></li>
            
                <li><a href="../classes/M.atto_bold.button.html">M.atto_bold.button</a></li>
            
                <li><a href="../classes/M.atto_charmap.button.html">M.atto_charmap.button</a></li>
            
                <li><a href="../classes/M.atto_clear.button.html">M.atto_clear.button</a></li>
            
                <li><a href="../classes/M.atto_collapse.button.html">M.atto_collapse.button</a></li>
            
                <li><a href="../classes/M.atto_emoticon.button.html">M.atto_emoticon.button</a></li>
            
                <li><a href="../classes/M.atto_equation.Button.html">M.atto_equation.Button</a></li>
            
                <li><a href="../classes/M.atto_fontcolor.button.html">M.atto_fontcolor.button</a></li>
            
                <li><a href="../classes/M.atto_html.button.html">M.atto_html.button</a></li>
            
                <li><a href="../classes/M.atto_image.Button.html">M.atto_image.Button</a></li>
            
                <li><a href="../classes/M.atto_indent.button.html">M.atto_indent.button</a></li>
            
                <li><a href="../classes/M.atto_italic.button.html">M.atto_italic.button</a></li>
            
                <li><a href="../classes/M.atto_link.button.html">M.atto_link.button</a></li>
            
                <li><a href="../classes/M.atto_managefiles.usedfiles.html">M.atto_managefiles.usedfiles</a></li>
            
                <li><a href="../classes/M.atto_media.Button.html">M.atto_media.Button</a></li>
            
                <li><a href="../classes/M.atto_noautolink.button.html">M.atto_noautolink.button</a></li>
            
                <li><a href="../classes/M.atto_orderedlist.button.html">M.atto_orderedlist.button</a></li>
            
                <li><a href="../classes/M.atto_rtl.button.html">M.atto_rtl.button</a></li>
            
                <li><a href="../classes/M.atto_strike.button.html">M.atto_strike.button</a></li>
            
                <li><a href="../classes/M.atto_subscript.button.html">M.atto_subscript.button</a></li>
            
                <li><a href="../classes/M.atto_superscript.button.html">M.atto_superscript.button</a></li>
            
                <li><a href="../classes/M.atto_table.Button.html">M.atto_table.Button</a></li>
            
                <li><a href="../classes/M.atto_title.button.html">M.atto_title.button</a></li>
            
                <li><a href="../classes/M.atto_underline.button.html">M.atto_underline.button</a></li>
            
                <li><a href="../classes/M.atto_undo.button.html">M.atto_undo.button</a></li>
            
                <li><a href="../classes/M.atto_unlink.button.html">M.atto_unlink.button</a></li>
            
                <li><a href="../classes/M.atto_unorderedlist.button.html">M.atto_unorderedlist.button</a></li>
            
                <li><a href="../classes/M.block_navigation.html">M.block_navigation</a></li>
            
                <li><a href="../classes/M.block_navigation.ActionKey.html">M.block_navigation.ActionKey</a></li>
            
                <li><a href="../classes/M.block_navigation.Branch.html">M.block_navigation.Branch</a></li>
            
                <li><a href="../classes/M.block_navigation.Tree.html">M.block_navigation.Tree</a></li>
            
                <li><a href="../classes/M.core.actionmenu.ActionMenu.html">M.core.actionmenu.ActionMenu</a></li>
            
                <li><a href="../classes/M.core.ajaxException.html">M.core.ajaxException</a></li>
            
                <li><a href="../classes/M.core.alert.html">M.core.alert</a></li>
            
                <li><a href="../classes/M.core.blockdraganddrop.BlockRegion.html">M.core.blockdraganddrop.BlockRegion</a></li>
            
                <li><a href="../classes/M.core.blockdraganddrop.LegacyManager.html">M.core.blockdraganddrop.LegacyManager</a></li>
            
                <li><a href="../classes/M.core.blockdraganddrop.Manager.html">M.core.blockdraganddrop.Manager</a></li>
            
                <li><a href="../classes/M.core.chooserdialogue.html">M.core.chooserdialogue</a></li>
            
                <li><a href="../classes/M.core.confirm.html">M.core.confirm</a></li>
            
                <li><a href="../classes/M.core.dialogue.html">M.core.dialogue</a></li>
            
                <li><a href="../classes/M.core.dock.ActionKey.html">M.core.dock.ActionKey</a></li>
            
                <li><a href="../classes/M.core.dock.Block.html">M.core.dock.Block</a></li>
            
                <li><a href="../classes/M.core.dock.Dock.html">M.core.dock.Dock</a></li>
            
                <li><a href="../classes/M.core.dock.DockedItem.html">M.core.dock.DockedItem</a></li>
            
                <li><a href="../classes/M.core.dock.Loader.html">M.core.dock.Loader</a></li>
            
                <li><a href="../classes/M.core.dock.Panel.html">M.core.dock.Panel</a></li>
            
                <li><a href="../classes/M.core.dock.TabHeightManager.html">M.core.dock.TabHeightManager</a></li>
            
                <li><a href="../classes/M.core.dragdrop.html">M.core.dragdrop</a></li>
            
                <li><a href="../classes/M.core.exception.html">M.core.exception</a></li>
            
                <li><a href="../classes/M.core.formchangechecker.html">M.core.formchangechecker</a></li>
            
                <li><a href="../classes/M.core.LockScroll.html">M.core.LockScroll</a></li>
            
                <li><a href="../classes/M.core.notification.html">M.core.notification</a></li>
            
                <li><a href="../classes/M.core.notification.info.html">M.core.notification.info</a></li>
            
                <li><a href="../classes/M.core.popuphelp.html">M.core.popuphelp</a></li>
            
                <li><a href="../classes/M.core.tooltip.html">M.core.tooltip</a></li>
            
                <li><a href="../classes/M.core.WidgetFocusAfterHide.html">M.core.WidgetFocusAfterHide</a></li>
            
                <li><a href="../classes/M.core_backup.backupselectall.html">M.core_backup.backupselectall</a></li>
            
                <li><a href="../classes/M.core_backup.confirmcancel.html">M.core_backup.confirmcancel</a></li>
            
                <li><a href="../classes/M.course.coursebase.html">M.course.coursebase</a></li>
            
                <li><a href="../classes/M.course.dragdrop.resource.html">M.course.dragdrop.resource</a></li>
            
                <li><a href="../classes/M.course.dragdrop.section.html">M.course.dragdrop.section</a></li>
            
                <li><a href="../classes/M.course.management.Category.html">M.course.management.Category</a></li>
            
                <li><a href="../classes/M.course.management.Console.html">M.course.management.Console</a></li>
            
                <li><a href="../classes/M.course.management.Course.html">M.course.management.Course</a></li>
            
                <li><a href="../classes/M.course.management.DragDrop.html">M.course.management.DragDrop</a></li>
            
                <li><a href="../classes/M.course.management.Item.html">M.course.management.Item</a></li>
            
                <li><a href="../classes/M.course.modchooser.html">M.course.modchooser</a></li>
            
                <li><a href="../classes/M.course.toolboxes.resources.html">M.course.toolboxes.resources</a></li>
            
                <li><a href="../classes/M.course.toolboxes.section.html">M.course.toolboxes.section</a></li>
            
                <li><a href="../classes/M.course.toolboxes.toolbox.html">M.course.toolboxes.toolbox</a></li>
            
                <li><a href="../classes/M.editor_atto.Editor.html">M.editor_atto.Editor</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorClean.html">M.editor_atto.EditorClean</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorFilepicker.html">M.editor_atto.EditorFilepicker</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorPlugin.html">M.editor_atto.EditorPlugin</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorPluginButtons.html">M.editor_atto.EditorPluginButtons</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorPluginDialogue.html">M.editor_atto.EditorPluginDialogue</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorSelection.html">M.editor_atto.EditorSelection</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorStyling.html">M.editor_atto.EditorStyling</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorTextArea.html">M.editor_atto.EditorTextArea</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorToolbar.html">M.editor_atto.EditorToolbar</a></li>
            
                <li><a href="../classes/M.editor_atto.EditorToolbarNav.html">M.editor_atto.EditorToolbarNav</a></li>
            
                <li><a href="../classes/M.editor_atto.Menu.html">M.editor_atto.Menu</a></li>
            
                <li><a href="../classes/M.form.shortforms.html">M.form.shortforms</a></li>
            
                <li><a href="../classes/M.form.showadvanced.html">M.form.showadvanced</a></li>
            
                <li><a href="../classes/M.mod_quiz.autosave.html">M.mod_quiz.autosave</a></li>
            
                <li><a href="../classes/M.tool_capability.Search.html">M.tool_capability.Search</a></li>
            
                <li><a href="../classes/Moodle.core_course.util.html">Moodle.core_course.util</a></li>
            
                <li><a href="../classes/Moodle.core_course.util.cm.html">Moodle.core_course.util.cm</a></li>
            
                <li><a href="../classes/Moodle.core_course.util.section.html">Moodle.core_course.util.section</a></li>
            
                <li><a href="../classes/Moodle.theme_bootstrapbase.bootstrap.html">Moodle.theme_bootstrapbase.bootstrap</a></li>
            
                <li><a href="../classes/Y.BootstrapEngine.html">Y.BootstrapEngine</a></li>
            
                <li><a href="../classes/Y.Moodle.course.categoryexpander.html">Y.Moodle.course.categoryexpander</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/buttons.html">buttons</a></li>
            
                <li><a href="../modules/clean.html">clean</a></li>
            
                <li><a href="../modules/dialogue.html">dialogue</a></li>
            
                <li><a href="../modules/filepicker.html">filepicker</a></li>
            
                <li><a href="../modules/gallery-bootstrap-collapse.html">gallery-bootstrap-collapse</a></li>
            
                <li><a href="../modules/gallery-bootstrap-dropdown.html">gallery-bootstrap-dropdown</a></li>
            
                <li><a href="../modules/gallery-bootstrap-engine.html">gallery-bootstrap-engine</a></li>
            
                <li><a href="../modules/menu-base.html">menu-base</a></li>
            
                <li><a href="../modules/moodle-assignfeedback_editpdf-editor.html">moodle-assignfeedback_editpdf-editor</a></li>
            
                <li><a href="../modules/moodle-atto-managefiles-button.html">moodle-atto-managefiles-button</a></li>
            
                <li><a href="../modules/moodle-atto_accessibilitychecker-button.html">moodle-atto_accessibilitychecker-button</a></li>
            
                <li><a href="../modules/moodle-atto_accessibilityhelper-button.html">moodle-atto_accessibilityhelper-button</a></li>
            
                <li><a href="../modules/moodle-atto_align-button.html">moodle-atto_align-button</a></li>
            
                <li><a href="../modules/moodle-atto_backcolor-button.html">moodle-atto_backcolor-button</a></li>
            
                <li><a href="../modules/moodle-atto_bold-button.html">moodle-atto_bold-button</a></li>
            
                <li><a href="../modules/moodle-atto_charmap-button.html">moodle-atto_charmap-button</a></li>
            
                <li><a href="../modules/moodle-atto_clear-button.html">moodle-atto_clear-button</a></li>
            
                <li><a href="../modules/moodle-atto_collapse-button.html">moodle-atto_collapse-button</a></li>
            
                <li><a href="../modules/moodle-atto_emoticon-button.html">moodle-atto_emoticon-button</a></li>
            
                <li><a href="../modules/moodle-atto_html-button.html">moodle-atto_html-button</a></li>
            
                <li><a href="../modules/moodle-atto_image_alignment-button.html">moodle-atto_image_alignment-button</a></li>
            
                <li><a href="../modules/moodle-atto_indent-button.html">moodle-atto_indent-button</a></li>
            
                <li><a href="../modules/moodle-atto_italic-button.html">moodle-atto_italic-button</a></li>
            
                <li><a href="../modules/moodle-atto_link-button.html">moodle-atto_link-button</a></li>
            
                <li><a href="../modules/moodle-atto_managefiles-usedfiles.html">moodle-atto_managefiles-usedfiles</a></li>
            
                <li><a href="../modules/moodle-atto_media-button.html">moodle-atto_media-button</a></li>
            
                <li><a href="../modules/moodle-atto_noautolink-button.html">moodle-atto_noautolink-button</a></li>
            
                <li><a href="../modules/moodle-atto_orderedlist-button.html">moodle-atto_orderedlist-button</a></li>
            
                <li><a href="../modules/moodle-atto_rtl-button.html">moodle-atto_rtl-button</a></li>
            
                <li><a href="../modules/moodle-atto_strike-button.html">moodle-atto_strike-button</a></li>
            
                <li><a href="../modules/moodle-atto_subscript-button.html">moodle-atto_subscript-button</a></li>
            
                <li><a href="../modules/moodle-atto_superscript-button.html">moodle-atto_superscript-button</a></li>
            
                <li><a href="../modules/moodle-atto_table-button.html">moodle-atto_table-button</a></li>
            
                <li><a href="../modules/moodle-atto_title-button.html">moodle-atto_title-button</a></li>
            
                <li><a href="../modules/moodle-atto_underline-button.html">moodle-atto_underline-button</a></li>
            
                <li><a href="../modules/moodle-atto_undo-button.html">moodle-atto_undo-button</a></li>
            
                <li><a href="../modules/moodle-atto_unlink-button.html">moodle-atto_unlink-button</a></li>
            
                <li><a href="../modules/moodle-atto_unorderedlist-button.html">moodle-atto_unorderedlist-button</a></li>
            
                <li><a href="../modules/moodle-backup-backupselectall.html">moodle-backup-backupselectall</a></li>
            
                <li><a href="../modules/moodle-backup-confirmcancel.html">moodle-backup-confirmcancel</a></li>
            
                <li><a href="../modules/moodle-block_navigation-navigation.html">moodle-block_navigation-navigation</a></li>
            
                <li><a href="../modules/moodle-core-actionmenu.html">moodle-core-actionmenu</a></li>
            
                <li><a href="../modules/moodle-core-blockdraganddrop.html">moodle-core-blockdraganddrop</a></li>
            
                <li><a href="../modules/moodle-core-chooserdialogue.html">moodle-core-chooserdialogue</a></li>
            
                <li><a href="../modules/moodle-core-dock.html">moodle-core-dock</a></li>
            
                <li><a href="../modules/moodle-core-dragdrop.html">moodle-core-dragdrop</a></li>
            
                <li><a href="../modules/moodle-core-formchangechecker.html">moodle-core-formchangechecker</a></li>
            
                <li><a href="../modules/moodle-core-lockscroll.html">moodle-core-lockscroll</a></li>
            
                <li><a href="../modules/moodle-core-maintenancemodetimer.html">moodle-core-maintenancemodetimer</a></li>
            
                <li><a href="../modules/moodle-core-notification.html">moodle-core-notification</a></li>
            
                <li><a href="../modules/moodle-core-notification-ajaxexception.html">moodle-core-notification-ajaxexception</a></li>
            
                <li><a href="../modules/moodle-core-notification-alert.html">moodle-core-notification-alert</a></li>
            
                <li><a href="../modules/moodle-core-notification-confirm.html">moodle-core-notification-confirm</a></li>
            
                <li><a href="../modules/moodle-core-notification-dialogue.html">moodle-core-notification-dialogue</a></li>
            
                <li><a href="../modules/moodle-core-notification-exception.html">moodle-core-notification-exception</a></li>
            
                <li><a href="../modules/moodle-core-popuphelp.html">moodle-core-popuphelp</a></li>
            
                <li><a href="../modules/moodle-core-tooltip.html">moodle-core-tooltip</a></li>
            
                <li><a href="../modules/moodle-core-widget-focusafterhide.html">moodle-core-widget-focusafterhide</a></li>
            
                <li><a href="../modules/moodle-course-categoryexpander.html">moodle-course-categoryexpander</a></li>
            
                <li><a href="../modules/moodle-course-coursebase.html">moodle-course-coursebase</a></li>
            
                <li><a href="../modules/moodle-course-dragdrop.html">moodle-course-dragdrop</a></li>
            
                <li><a href="../modules/moodle-course-management.html">moodle-course-management</a></li>
            
                <li><a href="../modules/moodle-course-modchooser.html">moodle-course-modchooser</a></li>
            
                <li><a href="../modules/moodle-course-toolboxes.html">moodle-course-toolboxes</a></li>
            
                <li><a href="../modules/moodle-course-util.html">moodle-course-util</a></li>
            
                <li><a href="../modules/moodle-course-util-cm.html">moodle-course-util-cm</a></li>
            
                <li><a href="../modules/moodle-course-util-section.html">moodle-course-util-section</a></li>
            
                <li><a href="../modules/moodle-editor_atto-editor.html">moodle-editor_atto-editor</a></li>
            
                <li><a href="../modules/moodle-editor_atto-menu.html">moodle-editor_atto-menu</a></li>
            
                <li><a href="../modules/moodle-editor_atto-plugin.html">moodle-editor_atto-plugin</a></li>
            
                <li><a href="../modules/moodle-form-shortforms.html">moodle-form-shortforms</a></li>
            
                <li><a href="../modules/moodle-form-showadvanced.html">moodle-form-showadvanced</a></li>
            
                <li><a href="../modules/moodle-mod_quiz-autosave.html">moodle-mod_quiz-autosave</a></li>
            
                <li><a href="../modules/moodle-question-preview.html">moodle-question-preview</a></li>
            
                <li><a href="../modules/moodle-tool_capability-search.html">moodle-tool_capability-search</a></li>
            
                <li><a href="../modules/plugin-base.html">plugin-base</a></li>
            
                <li><a href="../modules/styling.html">styling</a></li>
            
                <li><a href="../modules/textarea.html">textarea</a></li>
            
                <li><a href="../modules/theme_bootstrapbase-bootstrap.html">theme_bootstrapbase-bootstrap</a></li>
            
                <li><a href="../modules/toolbar.html">toolbar</a></li>
            
                <li><a href="../modules/toolbarnav.html">toolbarnav</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: lib/editor/atto/plugins/table/yui/src/button/js/button.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
// This file is part of Moodle - http://moodle.org/
//
// Moodle is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// Moodle is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.

/**
 * @package    atto_table
 * @copyright  2013 Damyon Wiese  &lt;damyon@moodle.com&gt;
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */

/**
 * @module moodle-atto_table-button
 */

/**
 * Atto text editor table plugin.
 *
 * @namespace M.atto_table
 * @class Button
 * @extends M.editor_atto.EditorPlugin
 */

var COMPONENT = &#x27;atto_table&#x27;,
    TEMPLATE = &#x27;&#x27; +
        &#x27;&lt;form class=&quot;atto_form&quot;&gt;&#x27; +
            &#x27;&lt;label for=&quot;{{elementid}}_atto_table_caption&quot;&gt;{{get_string &quot;caption&quot; component}}&lt;/label&gt;&#x27; +
            &#x27;&lt;textarea class=&quot;caption&quot; id=&quot;{{elementid}}_atto_table_caption&quot; rows=&quot;4&quot; class=&quot;fullwidth&quot; required&gt;&lt;/textarea&gt;&#x27; +
            &#x27;&lt;br/&gt;&#x27; +
            &#x27;&lt;label for=&quot;{{elementid}}_atto_table_headers&quot; class=&quot;sameline&quot;&gt;{{get_string &quot;headers&quot; component}}&lt;/label&gt;&#x27; +
            &#x27;&lt;select class=&quot;headers&quot; id=&quot;{{elementid}}_atto_table_headers&quot;&gt;&#x27; +
                &#x27;&lt;option value=&quot;columns&quot;&gt;{{get_string &quot;columns&quot; component}}&#x27; + &#x27;&lt;/option&gt;&#x27; +
                &#x27;&lt;option value=&quot;rows&quot;&gt;{{get_string &quot;rows&quot; component}}&#x27; + &#x27;&lt;/option&gt;&#x27; +
                &#x27;&lt;option value=&quot;both&quot;&gt;{{get_string &quot;both&quot; component}}&#x27; + &#x27;&lt;/option&gt;&#x27; +
            &#x27;&lt;/select&gt;&#x27; +
            &#x27;&lt;br/&gt;&#x27; +
            &#x27;&lt;label for=&quot;{{elementid}}_atto_table_rows&quot; class=&quot;sameline&quot;&gt;{{get_string &quot;numberofrows&quot; component}}&lt;/label&gt;&#x27; +
            &#x27;&lt;input class=&quot;rows&quot; type=&quot;number&quot; value=&quot;3&quot; id=&quot;{{elementid}}_atto_table_rows&quot; size=&quot;8&quot; min=&quot;1&quot; max=&quot;50&quot;/&gt;&#x27; +
            &#x27;&lt;br/&gt;&#x27; +
            &#x27;&lt;label for=&quot;{{elementid}}_atto_table_columns&quot; class=&quot;sameline&quot;&gt;{{get_string &quot;numberofcolumns&quot; component}}&lt;/label&gt;&#x27; +
            &#x27;&lt;input class=&quot;columns&quot; type=&quot;number&quot; value=&quot;3&quot; id=&quot;{{elementid}}_atto_table_columns&quot; size=&quot;8&quot; min=&quot;1&quot; max=&quot;20&quot;/&gt;&#x27; +
            &#x27;&lt;br/&gt;&#x27; +
            &#x27;&lt;div class=&quot;mdl-align&quot;&gt;&#x27; +
                &#x27;&lt;br/&gt;&#x27; +
                &#x27;&lt;button class=&quot;submit&quot; type=&quot;submit&quot;&gt;{{get_string &quot;createtable&quot; component}}&lt;/button&gt;&#x27; +
            &#x27;&lt;/div&gt;&#x27; +
        &#x27;&lt;/form&gt;&#x27; +
        &#x27;&lt;hr/&gt;{{{get_string &quot;accessibilityhint&quot; component}}}&#x27;,
    CONTEXTMENUTEMPLATE = &#x27;&#x27; +
        &#x27;&lt;ul&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;addcolumnafter&quot;&gt;{{get_string &quot;addcolumnafter&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;addrowafter&quot;&gt;{{get_string &quot;addrowafter&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;moverowup&quot;&gt;{{get_string &quot;moverowup&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;moverowdown&quot;&gt;{{get_string &quot;moverowdown&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;movecolumnleft&quot;&gt;{{get_string &quot;movecolumnleft&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;movecolumnright&quot;&gt;{{get_string &quot;movecolumnright&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;deleterow&quot;&gt;{{get_string &quot;deleterow&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
            &#x27;&lt;li&gt;&lt;a href=&quot;#&quot; data-change=&quot;deletecolumn&quot;&gt;{{get_string &quot;deletecolumn&quot; component}}&lt;/a&gt;&lt;/li&gt;&#x27; +
        &#x27;&lt;/ul&gt;&#x27;;

    CSS = {
    };

Y.namespace(&#x27;M.atto_table&#x27;).Button = Y.Base.create(&#x27;button&#x27;, Y.M.editor_atto.EditorPlugin, [], {

    /**
     * A reference to the current selection at the time that the dialogue
     * was opened.
     *
     * @property _currentSelection
     * @type Range
     * @private
     */
    _currentSelection: null,

    /**
     * The contextual menu that we can open.
     *
     * @property _contextMenu
     * @type M.editor_atto.Menu
     * @private
     */
    _contextMenu: null,

    /**
     * The last modified target.
     *
     * @property _lastTarget
     * @type Node
     * @private
     */
    _lastTarget: null,

    initializer: function() {
        this.addButton({
            icon: &#x27;e/table&#x27;,
            callback: this._displayTableEditor,
            tags: &#x27;table&#x27;
        });

        // Disable mozilla table controls.
        if (Y.UA.gecko) {
            document.execCommand(&quot;enableInlineTableEditing&quot;, false, false);
            document.execCommand(&quot;enableObjectResizing&quot;, false, false);
        }
    },

    /**
     * Display the table tool.
     *
     * @method _displayDialogue
     * @private
     */
    _displayDialogue: function() {
        // Store the current cursor position.
        this._currentSelection = this.get(&#x27;host&#x27;).getSelection();

        if (this._currentSelection !== false &amp;&amp; (!this._currentSelection.collapsed)) {
            var dialogue = this.getDialogue({
                headerContent: M.util.get_string(&#x27;createtable&#x27;, COMPONENT),
                focusAfterHide: true
            });

            // Set the dialogue content, and then show the dialogue.
            dialogue.set(&#x27;bodyContent&#x27;, this._getDialogueContent())
                    .show();
        }
    },

    /**
     * Display the appropriate table editor.
     *
     * If the current selection includes a table, then we show the
     * contextual menu, otherwise show the table creation dialogue.
     *
     * @method _displayTableEditor
     * @param {EventFacade} e
     * @private
     */
    _displayTableEditor: function(e) {
        var selection = this.get(&#x27;host&#x27;).getSelectionParentNode(),
            cell;

        if (!selection) {
            // We don&#x27;t have a current selection at all, so show the standard dialogue.
            return this._displayDialogue(e);
        }

        // Check all of the table cells found in the selection.
        Y.one(selection).ancestors(&#x27;th, td&#x27;, true).each(function(node) {
            if (this.editor.contains(node)) {
                cell = node;
            }
        }, this);

        if (cell) {
            // Add the cell to the EventFacade to save duplication in when showing the menu.
            e.tableCell = cell;
            return this._showTableMenu(e);
        }

        return this._displayDialogue(e);
    },

    /**
     * Return the dialogue content for the tool, attaching any required
     * events.
     *
     * @method _getDialogueContent
     * @private
     * @return {Node} The content to place in the dialogue.
     */
    _getDialogueContent: function() {
        var template = Y.Handlebars.compile(TEMPLATE);
        this._content = Y.Node.create(template({
                CSS: CSS,
                elementid: this.get(&#x27;host&#x27;).get(&#x27;elementid&#x27;),
                component: COMPONENT
            }));

        // Handle table setting.
        this._content.one(&#x27;.submit&#x27;).on(&#x27;click&#x27;, this._setTable, this);

        return this._content;
    },

    /**
     * Handle creation of a new table.
     *
     * @method _setTable
     * @param {EventFacade} e
     * @private
     */
    _setTable: function(e) {
        var caption,
            rows,
            cols,
            headers,
            tablehtml,
            i, j;

        e.preventDefault();

        // Hide the dialogue.
        this.getDialogue({
            focusAfterHide: null
        }).hide();

        caption = e.currentTarget.ancestor(&#x27;.atto_form&#x27;).one(&#x27;.caption&#x27;);
        rows = e.currentTarget.ancestor(&#x27;.atto_form&#x27;).one(&#x27;.rows&#x27;);
        cols = e.currentTarget.ancestor(&#x27;.atto_form&#x27;).one(&#x27;.columns&#x27;);
        headers = e.currentTarget.ancestor(&#x27;.atto_form&#x27;).one(&#x27;.headers&#x27;);

        // Set the selection.
        this.get(&#x27;host&#x27;).setSelection(this._currentSelection);

        // Note there are some spaces inserted in the cells and before and after, so that users have somewhere to click.
        var nl = &quot;\n&quot;;
        tablehtml = &#x27;&lt;br/&gt;&#x27; + nl + &#x27;&lt;table&gt;&#x27; + nl;
        tablehtml += &#x27;&lt;caption&gt;&#x27; + Y.Escape.html(caption.get(&#x27;value&#x27;)) + &#x27;&lt;/caption&gt;&#x27; + nl;

        i = 0;
        if (headers.get(&#x27;value&#x27;) === &#x27;columns&#x27; || headers.get(&#x27;value&#x27;) === &#x27;both&#x27;) {
            i = 1;
            tablehtml += &#x27;&lt;thead&gt;&#x27; + nl + &#x27;&lt;tr&gt;&#x27; + nl;
            for (j = 0; j &lt; parseInt(cols.get(&#x27;value&#x27;), 10); j++) {
                tablehtml += &#x27;&lt;th scope=&quot;col&quot;&gt;&lt;/th&gt;&#x27; + nl;
            }
            tablehtml += &#x27;&lt;/tr&gt;&#x27; + nl + &#x27;&lt;/thead&gt;&#x27; + nl;
        }
        tablehtml += &#x27;&lt;tbody&gt;&#x27; + nl;
        for (; i &lt; parseInt(rows.get(&#x27;value&#x27;), 10); i++) {
            tablehtml += &#x27;&lt;tr&gt;&#x27; + nl;
            for (j = 0; j &lt; parseInt(cols.get(&#x27;value&#x27;), 10); j++) {
                if (j === 0 &amp;&amp; (headers.get(&#x27;value&#x27;) === &#x27;rows&#x27; || headers.get(&#x27;value&#x27;) === &#x27;both&#x27;)) {
                    tablehtml += &#x27;&lt;th scope=&quot;row&quot;&gt;&lt;/th&gt;&#x27; + nl;
                } else {
                    tablehtml += &#x27;&lt;td&gt;&lt;/td&gt;&#x27; + nl;
                }
            }
            tablehtml += &#x27;&lt;/tr&gt;&#x27; + nl;
        }
        tablehtml += &#x27;&lt;/tbody&gt;&#x27; + nl;
        tablehtml += &#x27;&lt;/table&gt;&#x27; + nl + &#x27;&lt;br/&gt;&#x27;;

        this.get(&#x27;host&#x27;).insertContentAtFocusPoint(tablehtml);

        // Mark the content as updated.
        this.markUpdated();
    },

    /**
     * Display the table menu.
     *
     * @method _showTableMenu
     * @param {EventFacade} e
     * @private
     */
    _showTableMenu: function(e) {
        e.preventDefault();

        var boundingBox;

        if (!this._contextMenu) {
            var template = Y.Handlebars.compile(CONTEXTMENUTEMPLATE),
                content = Y.Node.create(template({
                    elementid: this.get(&#x27;host&#x27;).get(&#x27;elementid&#x27;),
                    component: COMPONENT
                }));

            this._contextMenu = new Y.M.editor_atto.Menu({
                headerText: M.util.get_string(&#x27;edittable&#x27;, &#x27;atto_table&#x27;),
                bodyContent: content
            });

            // Add event handlers for table control menus.
            boundingBox = this._contextMenu.get(&#x27;boundingBox&#x27;);
            boundingBox.delegate(&#x27;click&#x27;, this._handleTableChange, &#x27;a&#x27;, this);
            boundingBox.delegate(&#x27;key&#x27;, this._handleTableChange, &#x27;down:enter,space&#x27;, &#x27;a&#x27;, this);
        }
        boundingBox = this._contextMenu.get(&#x27;boundingBox&#x27;);

        // We store the cell of the last click (the control node is transient).
        this._lastTarget = e.tableCell.ancestor(&#x27;.editor_atto_content td, .editor_atto_content th&#x27;, true);

        // Show the context menu, and align to the current position.
        this._contextMenu.show();
        this._contextMenu.align(e.tableCell, [Y.WidgetPositionAlign.TL, Y.WidgetPositionAlign.BL]);

        // If there are any anchors in the bounding box, focus on the first.
        if (boundingBox.one(&#x27;a&#x27;)) {
            boundingBox.one(&#x27;a&#x27;).focus();
        }
    },

    /**
     * Handle a selection from the table control menu.
     *
     * @method _handleTableChange
     * @param {EventFacade} e
     * @private
     */
    _handleTableChange: function(e) {
        e.preventDefault();

        // Hide the context menu.
        this._contextMenu.hide();

        // Make our changes.
        switch (e.target.getData(&#x27;change&#x27;)) {
            case &#x27;addcolumnafter&#x27;:
                this._addColumnAfter();
                break;
            case &#x27;addrowafter&#x27;:
                this._addRowAfter();
                break;
            case &#x27;deleterow&#x27;:
                this._deleteRow();
                break;
            case &#x27;deletecolumn&#x27;:
                this._deleteColumn();
                break;
            case &#x27;moverowdown&#x27;:
                this._moveRowDown();
                break;
            case &#x27;moverowup&#x27;:
                this._moveRowUp();
                break;
            case &#x27;movecolumnleft&#x27;:
                this._moveColumnLeft();
                break;
            case &#x27;movecolumnright&#x27;:
                this._moveColumnRight();
                break;
        }
    },

    /**
     * Determine the index of a row in a table column.
     *
     * @method _getRowIndex
     * @param {Node} cell
     * @private
     */
    _getRowIndex: function(cell) {
        var tablenode = cell.ancestor(&#x27;table&#x27;),
            rownode = cell.ancestor(&#x27;tr&#x27;);

        if (!tablenode || !rownode) {
            return;
        }

        var rows = tablenode.all(&#x27;tr&#x27;);

        return rows.indexOf(rownode);
    },

    /**
     * Determine the index of a column in a table row.
     *
     * @method _getColumnIndex
     * @param {Node} cellnode
     * @private
     */
    _getColumnIndex: function(cellnode) {
        var rownode = cellnode.ancestor(&#x27;tr&#x27;);

        if (!rownode) {
            return;
        }

        var cells = rownode.all(&#x27;td, th&#x27;);

        return cells.indexOf(cellnode);
    },

    /**
     * Delete the current row.
     *
     * @method _deleteRow
     * @private
     */
    _deleteRow: function() {
        var row = this._lastTarget.ancestor(&#x27;tr&#x27;);

        if (row) {
            // We do not remove rows with no cells (all headers).
            if (row.one(&#x27;td&#x27;)) {
                row.remove(true);
            }
        }

        // Clean the HTML.
        this.markUpdated();
    },

    /**
     * Move row up
     *
     * @method _moveRowUp
     * @private
     */
    _moveRowUp: function() {
        var row = this._lastTarget.ancestor(&#x27;tr&#x27;);
        var prevrow = row.previous(&#x27;tr&#x27;);
        if (!row || !prevrow) {
            return;
        }

        row.swap(prevrow);
        // Clean the HTML.
        this.markUpdated();
    },

    /**
     * Move column left
     *
     * @method _moveColumnLeft
     * @private
     */
    _moveColumnLeft: function() {
        var columnindex = this._getColumnIndex(this._lastTarget);
        var rows = this._lastTarget.ancestor(&#x27;table&#x27;).all(&#x27;tr&#x27;);
        var columncells = new Y.NodeList();
        var prevcells = new Y.NodeList();
        var hastd = false;

        rows.each(function(row) {
            var cells = row.all(&#x27;td, th&#x27;);
            var cell = cells.item(columnindex),
                cellprev = cells.item(columnindex-1);
            columncells.push(cell);
            if (cellprev) {
                if (cellprev.get(&#x27;tagName&#x27;) === &#x27;TD&#x27;) {
                    hastd = true;
                }
                prevcells.push(cellprev);
            }
        });

        if (hastd &amp;&amp; prevcells.size() &gt; 0) {
            var i = 0;
            for (i = 0; i &lt; columncells.size(); i++) {
                var cell = columncells.item(i);
                var prevcell = prevcells.item(i);

                cell.swap(prevcell);
            }
        }
        // Cleanup.
        this.markUpdated();
    },

    /**
     * Move column right.
     *
     * @method _moveColumnRight
     * @private
     */
    _moveColumnRight: function() {
        var columnindex = this._getColumnIndex(this._lastTarget);
        var rows = this._lastTarget.ancestor(&#x27;table&#x27;).all(&#x27;tr&#x27;);
        var columncells = new Y.NodeList();
        var nextcells = new Y.NodeList();
        var hastd = false;

        rows.each(function(row) {
            var cells = row.all(&#x27;td, th&#x27;);
            var cell = cells.item(columnindex),
                cellnext = cells.item(columnindex+1);
            if (cell.get(&#x27;tagName&#x27;) === &#x27;TD&#x27;) {
                hastd = true;
            }
            columncells.push(cell);
            if (cellnext) {
                nextcells.push(cellnext);
            }
        });

        if (hastd &amp;&amp; nextcells.size() &gt; 0) {
            var i = 0;
            for (i = 0; i &lt; columncells.size(); i++) {
                var cell = columncells.item(i);
                var nextcell = nextcells.item(i);

                cell.swap(nextcell);
            }
        }
        // Cleanup.
        this.markUpdated();
    },

    /**
     * Move row down.
     *
     * @method _moveRowDown
     * @private
     */
    _moveRowDown: function() {
        var row = this._lastTarget.ancestor(&#x27;tr&#x27;);
        var nextrow = row.next(&#x27;tr&#x27;);
        if (!row || !nextrow) {
            return;
        }

        row.swap(nextrow);
        // Clean the HTML.
        this.markUpdated();
    },

    /**
     * Delete the current column.
     *
     * @method _deleteColumn
     * @private
     */
    _deleteColumn: function() {
        var columnindex = this._getColumnIndex(this._lastTarget);
        var rows = this._lastTarget.ancestor(&#x27;table&#x27;).all(&#x27;tr&#x27;);
        var columncells = new Y.NodeList();
        var hastd = false;

        rows.each(function(row) {
            var cells = row.all(&#x27;td, th&#x27;);
            var cell = cells.item(columnindex);
            if (cell.get(&#x27;tagName&#x27;) === &#x27;TD&#x27;) {
                hastd = true;
            }
            columncells.push(cell);
        });

        if (hastd) {
            columncells.remove(true);
        }

        // Clean the HTML.
        this.markUpdated();
    },

    /**
     * Add a row after the current row.
     *
     * @method _addRowAfter
     * @private
     */
    _addRowAfter: function() {
        var rowindex = this._getRowIndex(this._lastTarget);

        var tablebody = this._lastTarget.ancestor(&#x27;table&#x27;).one(&#x27;tbody&#x27;);
        if (!tablebody) {
            // Not all tables have tbody.
            tablebody = this._lastTarget.ancestor(&#x27;table&#x27;);
            rowindex += 1;
        }

        var firstrow = tablebody.one(&#x27;tr&#x27;);
        if (!firstrow) {
            firstrow = this._lastTarget.ancestor(&#x27;table&#x27;).one(&#x27;tr&#x27;);
        }
        if (!firstrow) {
            // Table has no rows. Boo.
            return;
        }
        newrow = firstrow.cloneNode(true);
        newrow.all(&#x27;th, td&#x27;).each(function (tablecell) {
            if (tablecell.get(&#x27;tagName&#x27;) === &#x27;TH&#x27;) {
                if (tablecell.getAttribute(&#x27;scope&#x27;) !== &#x27;row&#x27;) {
                    var newcell = Y.Node.create(&#x27;&lt;td&gt;&lt;/td&gt;&#x27;);
                    tablecell.replace(newcell);
                    tablecell = newcell;
                }
            }
            tablecell.setHTML(&#x27;&amp;nbsp;&#x27;);
        });

        tablebody.insert(newrow, rowindex);

        // Clean the HTML.
        this.markUpdated();
    },

    /**
     * Add a column after the current column.
     *
     * @method _addColumnAfter
     * @private
     */
    _addColumnAfter: function() {
        var columnindex = this._getColumnIndex(this._lastTarget);

        var tablecell = this._lastTarget.ancestor(&#x27;table&#x27;);
        var rows = tablecell.all(&#x27;tr&#x27;);
        Y.each(rows, function(row) {
            // Clone the first cell from the row so it has the same type/attributes (e.g. scope).
            var newcell = row.one(&#x27;td, th&#x27;).cloneNode(true);
            // Clear the content of the cell.
            newcell.setHTML(&#x27;&amp;nbsp;&#x27;);

            row.insert(newcell, columnindex + 1);
        }, this);

        // Clean the HTML.
        this.markUpdated();
    }
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
